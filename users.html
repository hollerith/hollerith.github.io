<!doctype html>
<html>
<head>
    <title>User Details</title>
    <meta name="viewport" content="width=device-width, user-scalable=no" />

    <link rel="manifest" href="manifest.json" />
    <link rel="icon" href="icons/icon-192x192.png" type="image/png" />
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-icon-180x180.png">
    <link rel="apple-touch-icon" sizes="167x167" href="icons/apple-icon-167x167.png">
    <link rel="apple-touch-icon" sizes="152x152" href="icons/apple-icon-152x152.png">

    <link rel="stylesheet" type="text/css" href="main.css">
    <script src="newt.js"></script>
    
    <script>
        const UserList = {
            _users: [],
            _selectedUser: null,
            $init: async function() {
                try {
                    const response = await fetch('https://jsonplaceholder.typicode.com/users');
                    this._users = await response.json();
                    this.$nodes = this._users.map(user => ({
                        $type: "div",
                        class: "user-row",
                        $text: user.name,
                        $events: {
                            click: function() {
                                this._selectUser(user.id);
                            }
                        }
                    }));
                } catch (error) {
                    console.error('Error fetching users:', error);
                }
            },
            _selectUser: function(userId) {
                this._selectedUser = this._users.find(user => user.id === userId);
                UserDetails.self._user = this._selectedUser;
            },
            $nodes: [
                {
                    $type: "div",
                    class: "user-row",
                    $text: "Loading users..."
                }
            ],
            $update: () => {}
        };

        const UserDetails = {
            id: 'UserDetails',
            _user: null,
            class: 'card',
            $update: function() {
                if (this._user) {
                    this.$nodes = [
                        { $type: "h2", $text: this._user.name },
                        { $type: "p", $text: `Username: ${this._user.username}` },
                        { $type: "p", $text: `Email: ${this._user.email}` },
                        { $type: "p", $text: `Phone: ${this._user.phone}` },
                        { $type: "p", $text: `Website: ${this._user.website}` },
                        { $type: "p", $text: `Company: ${this._user.company.name}` }
                    ];
                } else {
                    this.$nodes = [{ $type: "p", $text: "Select a user to see details." }];
                }
            },
            $nodes: [{ $type: "p", $text: "Select a user to see details." }]
        };

        var App = {
            $app: true,
            id: "app",
            $nodes: [
                { $type: "div", class: "layout", $nodes: [
                    { $type: "div", class: "user-list", $nodes: [UserList] },
                    { $type: "div", class: "user-detail-view", $nodes: [UserDetails] }
                ]}
            ]
        };
    </script>
</head>
<body>
    <style>
        .layout {
            display: flex;
        }
        .user-list {
            width: 30%;
            border-right: 1px solid #ccc;
            padding: 10px;
        }
        .user-row {
            padding: 5px;
            cursor: pointer;
        }
        .user-row:hover {
            background-color: #f0f0f0;
        }
        .user-detail-view {
            width: 70%;
            padding: 10px;
        }
    </style>
    <main>       
        <nav>
            <h1>User Details</h1>
        </nav>
        <div id="app"></div>
        <footer>
            <p>Made With &hearts; By Hand</p>
        </footer>
    </main>
    <noscript>
        Turn on JavaScript to access this site content.
    </noscript>
</body>
</html>
